{"id":"DPRK","dependencies":[{"name":"/Users/humengqiao/Desktop/node-project/trash-classify/package.json","includedInParent":true,"mtime":1609564004117},{"name":"react","loc":{"line":1,"column":37},"parent":"/Users/humengqiao/Desktop/node-project/trash-classify/app/App.jsx","resolved":"/Users/humengqiao/Desktop/node-project/trash-classify/node_modules/react/index.js"},{"name":"antd","loc":{"line":2,"column":33},"parent":"/Users/humengqiao/Desktop/node-project/trash-classify/app/App.jsx","resolved":"/Users/humengqiao/Desktop/node-project/trash-classify/node_modules/antd/es/index.js"},{"name":"antd/dist/antd.css","loc":{"line":3,"column":7},"parent":"/Users/humengqiao/Desktop/node-project/trash-classify/app/App.jsx","resolved":"/Users/humengqiao/Desktop/node-project/trash-classify/node_modules/antd/dist/antd.css"},{"name":"@tensorflow/tfjs","loc":{"line":4,"column":20},"parent":"/Users/humengqiao/Desktop/node-project/trash-classify/app/App.jsx","resolved":"/Users/humengqiao/Desktop/node-project/trash-classify/node_modules/@tensorflow/tfjs/dist/index.js"},{"name":"./utils","loc":{"line":5,"column":37},"parent":"/Users/humengqiao/Desktop/node-project/trash-classify/app/App.jsx","resolved":"/Users/humengqiao/Desktop/node-project/trash-classify/app/utils.js"},{"name":"./intro","loc":{"line":6,"column":18},"parent":"/Users/humengqiao/Desktop/node-project/trash-classify/app/App.jsx","resolved":"/Users/humengqiao/Desktop/node-project/trash-classify/app/intro.js"}],"generated":{"js":"\"use strict\";Object.defineProperty(exports,\"__esModule\",{value:!0}),exports.default=void 0;var e=i(require(\"react\")),t=require(\"antd\");require(\"antd/dist/antd.css\");var r=i(require(\"@tensorflow/tfjs\")),l=require(\"./utils\"),n=a(require(\"./intro\"));function a(e){return e&&e.__esModule?e:{default:e}}function s(){if(\"function\"!=typeof WeakMap)return null;var e=new WeakMap;return s=function(){return e},e}function i(e){if(e&&e.__esModule)return e;if(null===e||\"object\"!=typeof e&&\"function\"!=typeof e)return{default:e};var t=s();if(t&&t.has(e))return t.get(e);var r={},l=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){var a=l?Object.getOwnPropertyDescriptor(e,n):null;a&&(a.get||a.set)?Object.defineProperty(r,n,a):r[n]=e[n]}return r.default=e,t&&t.set(e,r),r}const o=\"http://localhost:9999\";class u extends e.PureComponent{constructor(e){super(e),this.state={}}async componentDidMount(){this.model=await r.loadLayersModel(o+\"/model.json\"),this.CLASSES=await fetch(o+\"/classes.json\").then(e=>e.json())}async predict(e){const t=await(0,l.file2img)(e);this.setState({imgSrc:t.src}),setTimeout(()=>{const e=r.tidy(()=>{const e=(0,l.img2Tensor)(t);return this.model.predict(e)}).arraySync()[0].map((e,t)=>({score:e,label:this.CLASSES[t]})).sort((e,t)=>t.score-e.score);this.setState({finalResult:e})},0)}renderResult(r){const l=Math.round(100*r.score);return e.default.createElement(\"tr\",{key:r.label},e.default.createElement(\"td\",{style:{width:80,padding:\"5px 0\"}},r.label),e.default.createElement(\"td\",null,e.default.createElement(t.Progress,{percent:l,status:100===l?\"success\":\"normal\"})))}render(){const{imgSrc:r,finalResult:l}=this.state,a=l&&{...l[0],...n.default[l[0].label]};return e.default.createElement(\"div\",null,e.default.createElement(t.Button,{type:\"primary\",style:{width:\"100%\"},onClick:()=>this.inputRef.click()},\"选择图片识别\"),e.default.createElement(\"input\",{ref:e=>this.inputRef=e,type:\"file\",style:{display:\"none\"},onChange:e=>this.predict(e.target.files[0])}),r&&e.default.createElement(\"div\",{style:{marginTop:20,textAlign:\"center\"}},e.default.createElement(\"img\",{src:r,style:{maxWidth:\"100%\",height:300}})),a&&e.default.createElement(\"div\",{style:{marginTop:20}},\"识别结果：\"),a&&e.default.createElement(\"div\",{style:{display:\"flex\",alignItems:\"flex-start\",marginTop:20}},e.default.createElement(\"img\",{src:a.icon,width:\"120\"}),e.default.createElement(\"div\",null,e.default.createElement(\"h2\",{style:{color:a.color}},a.label),e.default.createElement(\"div\",{style:{color:a.color}},a.intro))),l&&e.default.createElement(\"div\",{style:{marginTop:20}},e.default.createElement(\"table\",{style:{width:\"100%\"}},e.default.createElement(\"tbody\",null,e.default.createElement(\"tr\",null,e.default.createElement(\"td\",null,\"类别\"),e.default.createElement(\"td\",null,\"匹配度\")),l.map(e=>this.renderResult(e))))))}}var c=u;exports.default=c;"},"sourceMaps":null,"error":null,"hash":"500ab98d5789d1ce313b25cfd8dd1328","cacheData":{"env":{}}}