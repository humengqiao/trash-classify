{"id":"C8io","dependencies":[{"name":"/Users/humengqiao/Desktop/node-project/trash-classify/package.json","includedInParent":true,"mtime":1609565602436},{"name":"/Users/humengqiao/Desktop/node-project/trash-classify/node_modules/@tensorflow/tfjs-layers/package.json","includedInParent":true,"mtime":499162500000},{"name":"@tensorflow/tfjs-core","loc":{"line":14,"column":51},"parent":"/Users/humengqiao/Desktop/node-project/trash-classify/node_modules/@tensorflow/tfjs-layers/dist/layers/normalization.js","resolved":"/Users/humengqiao/Desktop/node-project/trash-classify/node_modules/@tensorflow/tfjs-core/dist/index.js"},{"name":"../constraints","loc":{"line":15,"column":51},"parent":"/Users/humengqiao/Desktop/node-project/trash-classify/node_modules/@tensorflow/tfjs-layers/dist/layers/normalization.js","resolved":"/Users/humengqiao/Desktop/node-project/trash-classify/node_modules/@tensorflow/tfjs-layers/dist/constraints.js"},{"name":"../engine/topology","loc":{"line":16,"column":33},"parent":"/Users/humengqiao/Desktop/node-project/trash-classify/node_modules/@tensorflow/tfjs-layers/dist/layers/normalization.js","resolved":"/Users/humengqiao/Desktop/node-project/trash-classify/node_modules/@tensorflow/tfjs-layers/dist/engine/topology.js"},{"name":"../errors","loc":{"line":17,"column":48},"parent":"/Users/humengqiao/Desktop/node-project/trash-classify/node_modules/@tensorflow/tfjs-layers/dist/layers/normalization.js","resolved":"/Users/humengqiao/Desktop/node-project/trash-classify/node_modules/@tensorflow/tfjs-layers/dist/errors.js"},{"name":"../initializers","loc":{"line":18,"column":53},"parent":"/Users/humengqiao/Desktop/node-project/trash-classify/node_modules/@tensorflow/tfjs-layers/dist/layers/normalization.js","resolved":"/Users/humengqiao/Desktop/node-project/trash-classify/node_modules/@tensorflow/tfjs-layers/dist/initializers.js"},{"name":"../regularizers","loc":{"line":19,"column":53},"parent":"/Users/humengqiao/Desktop/node-project/trash-classify/node_modules/@tensorflow/tfjs-layers/dist/layers/normalization.js","resolved":"/Users/humengqiao/Desktop/node-project/trash-classify/node_modules/@tensorflow/tfjs-layers/dist/regularizers.js"},{"name":"../utils/generic_utils","loc":{"line":20,"column":31},"parent":"/Users/humengqiao/Desktop/node-project/trash-classify/node_modules/@tensorflow/tfjs-layers/dist/layers/normalization.js","resolved":"/Users/humengqiao/Desktop/node-project/trash-classify/node_modules/@tensorflow/tfjs-layers/dist/utils/generic_utils.js"},{"name":"../utils/math_utils","loc":{"line":21,"column":28},"parent":"/Users/humengqiao/Desktop/node-project/trash-classify/node_modules/@tensorflow/tfjs-layers/dist/layers/normalization.js","resolved":"/Users/humengqiao/Desktop/node-project/trash-classify/node_modules/@tensorflow/tfjs-layers/dist/utils/math_utils.js"},{"name":"../utils/types_utils","loc":{"line":22,"column":56},"parent":"/Users/humengqiao/Desktop/node-project/trash-classify/node_modules/@tensorflow/tfjs-layers/dist/layers/normalization.js","resolved":"/Users/humengqiao/Desktop/node-project/trash-classify/node_modules/@tensorflow/tfjs-layers/dist/utils/types_utils.js"}],"generated":{"js":"\"use strict\";Object.defineProperty(exports,\"__esModule\",{value:!0}),exports.batchNormalization=g,exports.normalizeBatchInTraining=z,exports.LayerNormalization=exports.BatchNormalization=void 0;var i=u(require(\"@tensorflow/tfjs-core\")),e=require(\"../constraints\"),t=require(\"../engine/topology\"),a=require(\"../errors\"),r=require(\"../initializers\"),s=require(\"../regularizers\"),n=u(require(\"../utils/generic_utils\")),l=u(require(\"../utils/math_utils\")),o=require(\"../utils/types_utils\");function h(){if(\"function\"!=typeof WeakMap)return null;var i=new WeakMap;return h=function(){return i},i}function u(i){if(i&&i.__esModule)return i;if(null===i||\"object\"!=typeof i&&\"function\"!=typeof i)return{default:i};var e=h();if(e&&e.has(i))return e.get(i);var t={},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var r in i)if(Object.prototype.hasOwnProperty.call(i,r)){var s=a?Object.getOwnPropertyDescriptor(i,r):null;s&&(s.get||s.set)?Object.defineProperty(t,r,s):t[r]=i[r]}return t.default=i,e&&e.set(i,t),t}function g(e,t,r,s,n,l=.001){let o;if(2===e.rank)o=i.batchNorm2d(e,t,r,s,n,l);else if(3===e.rank)o=i.batchNorm3d(e,t,r,s,n,l);else{if(4!==e.rank)throw new a.NotImplementedError(`batchNormalization is not implemented for array of rank ${e.rank} `+\"yet\");o=i.batchNorm4d(e,t,r,s,n,l)}return o}function m(e,t,a,r,s=.001){return(0,i.tidy)(()=>{const n=i.moments(e,r),l=n.mean,o=n.variance;return[g(e,l,o,a,t,s),l,o]})}function c(e,t,a,r,s=.001){return(0,i.tidy)(()=>{const n=i.moments(e,r),o=n.mean,h=n.variance,u=[];for(const i of l.range(0,e.rank))-1!==r.indexOf(i)?u.push(1):u.push(e.shape[i]);const m=o.reshape(u),c=h.reshape(u),z=null==t?null:t.reshape(u),p=null==a?null:a.reshape(u);return[g(e,m,c,p,z,s),o,h]})}function z(e,t,a,r,s=.001){return i.util.arraysEqual(r.slice().sort(),l.range(0,e.rank-1))?m(e,t,a,r,s):c(e,t,a,r,s)}class p extends t.Layer{constructor(i){null==i&&(i={}),super(i),this.supportsMasking=!0,this.axis=null==i.axis?-1:i.axis,this.momentum=null==i.momentum?.99:i.momentum,this.epsilon=null==i.epsilon?.001:i.epsilon,this.center=null==i.center||i.center,this.scale=null==i.scale||i.scale,this.betaInitializer=(0,r.getInitializer)(i.betaInitializer||\"zeros\"),this.gammaInitializer=(0,r.getInitializer)(i.gammaInitializer||\"ones\"),this.movingMeanInitializer=(0,r.getInitializer)(i.movingMeanInitializer||\"zeros\"),this.movingVarianceInitializer=(0,r.getInitializer)(i.movingVarianceInitializer||\"ones\"),this.betaConstraint=(0,e.getConstraint)(i.betaConstraint),this.gammaConstraint=(0,e.getConstraint)(i.gammaConstraint),this.betaRegularizer=(0,s.getRegularizer)(i.betaRegularizer),this.gammaRegularizer=(0,s.getRegularizer)(i.gammaRegularizer)}build(i){i=(0,o.getExactlyOneShape)(i);const e=this.axis>=0?this.axis:this.axis+i.length,r=i[e];if(null==r)throw new a.ValueError(`Axis ${e} of input tensor should have a defined dimension but `+\"the layer received an input with shape \"+`${JSON.stringify(i)}.`);this.inputSpec=[new t.InputSpec({ndim:i.length,axes:{[e]:r}})];const s=[r];this.scale&&(this.gamma=this.addWeight(\"gamma\",s,null,this.gammaInitializer,this.gammaRegularizer,!0,this.gammaConstraint)),this.center&&(this.beta=this.addWeight(\"beta\",s,null,this.betaInitializer,this.betaRegularizer,!0,this.betaConstraint)),this.movingMean=this.addWeight(\"moving_mean\",s,null,this.movingMeanInitializer,null,!1),this.movingVariance=this.addWeight(\"moving_variance\",s,null,this.movingVarianceInitializer,null,!1),this.built=!0}call(e,t){return(0,i.tidy)(()=>{const a=null!=t.training&&t.training,r=(0,o.getExactlyOneTensor)(e),s=r.shape,h=s.length,u=l.range(0,h),m=this.axis>=0?this.axis:this.axis+h;u.splice(m,1);const c=n.pyListRepeat(1,h);c[m]=s[m];const p=u.slice();p.sort();const b=!i.util.arraysEqual(p,l.range(0,h).slice(0,h-1));if(!a)return(()=>{if(b){const i=this.movingMean.read().reshape(c),e=this.movingVariance.read().reshape(c),t=this.center?this.beta.read().reshape(c):null,a=this.scale?this.gamma.read().reshape(c):null;return g(r,i,e,t,a,this.epsilon)}return g(r,this.movingMean.read(),this.movingVariance.read(),null==this.beta?null:this.beta.read(),null==this.gamma?null:this.gamma.read(),this.epsilon)})();const[f,d,x]=z(r,this.gamma.read(),this.beta.read(),u,this.epsilon),I=(e,t,a)=>{i.tidy(()=>{const i=1-a,r=e.read(),s=r.sub(t).mul(i);e.write(r.sub(s))})};return(()=>{I(this.movingMean,d,this.momentum),I(this.movingVariance,x,this.momentum)})(),f})}getConfig(){const i={axis:this.axis,momentum:this.momentum,epsilon:this.epsilon,center:this.center,scale:this.scale,betaInitializer:(0,r.serializeInitializer)(this.betaInitializer),gammaInitializer:(0,r.serializeInitializer)(this.gammaInitializer),movingMeanInitializer:(0,r.serializeInitializer)(this.movingMeanInitializer),movingVarianceInitializer:(0,r.serializeInitializer)(this.movingVarianceInitializer),betaRegularizer:(0,s.serializeRegularizer)(this.betaRegularizer),gammaRegularizer:(0,s.serializeRegularizer)(this.gammaRegularizer),betaConstraint:(0,e.serializeConstraint)(this.betaConstraint),gammaConstraint:(0,e.serializeConstraint)(this.gammaConstraint)},t=super.getConfig();return Object.assign(i,t),i}}exports.BatchNormalization=p,p.className=\"BatchNormalization\",i.serialization.registerClass(p);class b extends t.Layer{constructor(i){if(null==i&&(i={}),super(i),this.axis=null==i.axis?-1:i.axis,\"number\"==typeof this.axis){if(!Number.isInteger(this.axis))throw new Error(`Expected axis to be an integer, but received ${this.axis}`)}else{if(!Array.isArray(this.axis))throw new Error(\"Expected axis to be an integer or an array of integers, \"+`but received ${JSON.stringify(this.axis)}`);for(const i of this.axis)if(!Number.isInteger(i))throw new Error(\"Expected axis to be an array of integers, \"+`but received ${JSON.stringify(this.axis)}`)}this.epsilon=null==i.epsilon?.001:i.epsilon,this.center=null==i.center||i.center,this.scale=null==i.scale||i.scale,this.betaInitializer=(0,r.getInitializer)(i.betaInitializer||\"zeros\"),this.gammaInitializer=(0,r.getInitializer)(i.gammaInitializer||\"ones\"),this.betaRegularizer=(0,s.getRegularizer)(i.betaRegularizer),this.gammaRegularizer=(0,s.getRegularizer)(i.gammaRegularizer),this.supportsMasking=!0}build(i){const e=(i=(0,o.getExactlyOneShape)(i)).length;\"number\"==typeof this.axis&&(this.axis=[this.axis]);for(let a=0;a<this.axis.length;++a)this.axis[a]<0&&(this.axis[a]+=e);for(const a of this.axis)if(a<0||a>=e)throw new Error(`Invalid axis: ${a}`);if(this.axis.length!==n.unique(this.axis).length)throw new Error(`Found duplicate axes in: ${this.axis}`);const t=this.axis.map(e=>i[e]);this.scale?this.gamma=this.addWeight(\"gamma\",t,\"float32\",this.gammaInitializer,this.gammaRegularizer,!0):this.gamma=null,this.center?this.beta=this.addWeight(\"beta\",t,\"float32\",this.betaInitializer,this.betaRegularizer,!0):this.beta=null,this.built=!0}call(e,t){const a=(0,o.getExactlyOneTensor)(e),r=a.shape,s=r.length;return(0,i.tidy)(()=>{let{mean:e,variance:t}=(0,i.moments)(a,this.axis,!0);const l=n.pyListRepeat(1,s);for(const i of this.axis)l[i]=r[i];const o=i=>null!=i&&i.shape.length!==s&&this.axis!==[s-1]?i.reshape(l):i;let h=o(this.gamma.read()),u=o(this.beta.read());const m=[],c=[];for(let i=0;i<s;++i)-1!==this.axis.indexOf(i)?(m.push(r[i]),c.push(1)):(m.push(1),c.push(r[i]));return e=e.tile(m),t=t.tile(m),h=h.tile(c),u=u.tile(c),g(a,e,t,u,h,this.epsilon)})}getConfig(){const i={axis:this.axis,epsilon:this.epsilon,center:this.center,scale:this.scale,betaInitializer:(0,r.serializeInitializer)(this.betaInitializer),gammaInitializer:(0,r.serializeInitializer)(this.gammaInitializer),betaRegularizer:(0,s.serializeRegularizer)(this.betaRegularizer),gammaRegularizer:(0,s.serializeRegularizer)(this.gammaRegularizer)},e=super.getConfig();return Object.assign(i,e),i}}exports.LayerNormalization=b,b.className=\"LayerNormalization\",i.serialization.registerClass(b);"},"sourceMaps":null,"error":null,"hash":"626f649f0d408c0c0b89ca71efe34ec8","cacheData":{"env":{}}}