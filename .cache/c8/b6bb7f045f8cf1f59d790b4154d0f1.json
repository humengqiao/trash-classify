{"id":"bqqF","dependencies":[{"name":"/Users/humengqiao/Desktop/node-project/trash-classify/package.json","includedInParent":true,"mtime":1609565653941},{"name":"/Users/humengqiao/Desktop/node-project/trash-classify/node_modules/@tensorflow/tfjs-core/package.json","includedInParent":true,"mtime":499162500000},{"name":"../flags","loc":{"line":17,"column":7},"parent":"/Users/humengqiao/Desktop/node-project/trash-classify/node_modules/@tensorflow/tfjs-core/dist/io/local_storage.js","resolved":"/Users/humengqiao/Desktop/node-project/trash-classify/node_modules/@tensorflow/tfjs-core/dist/flags.js"},{"name":"../environment","loc":{"line":18,"column":20},"parent":"/Users/humengqiao/Desktop/node-project/trash-classify/node_modules/@tensorflow/tfjs-core/dist/io/local_storage.js","resolved":"/Users/humengqiao/Desktop/node-project/trash-classify/node_modules/@tensorflow/tfjs-core/dist/environment.js"},{"name":"../util","loc":{"line":19,"column":23},"parent":"/Users/humengqiao/Desktop/node-project/trash-classify/node_modules/@tensorflow/tfjs-core/dist/io/local_storage.js","resolved":"/Users/humengqiao/Desktop/node-project/trash-classify/node_modules/@tensorflow/tfjs-core/dist/util.js"},{"name":"./io_utils","loc":{"line":20,"column":99},"parent":"/Users/humengqiao/Desktop/node-project/trash-classify/node_modules/@tensorflow/tfjs-core/dist/io/local_storage.js","resolved":"/Users/humengqiao/Desktop/node-project/trash-classify/node_modules/@tensorflow/tfjs-core/dist/io/io_utils.js"},{"name":"./router_registry","loc":{"line":21,"column":33},"parent":"/Users/humengqiao/Desktop/node-project/trash-classify/node_modules/@tensorflow/tfjs-core/dist/io/local_storage.js","resolved":"/Users/humengqiao/Desktop/node-project/trash-classify/node_modules/@tensorflow/tfjs-core/dist/io/router_registry.js"}],"generated":{"js":"\"use strict\";Object.defineProperty(exports,\"__esModule\",{value:!0}),exports.purgeLocalStorageArtifacts=d,exports.browserLocalStorage=f,exports.BrowserLocalStorageManager=exports.localStorageRouter=exports.BrowserLocalStorage=void 0,require(\"../flags\");var e=require(\"../environment\"),t=require(\"../util\"),o=require(\"./io_utils\"),r=require(\"./router_registry\");const s=\"/\",i=\"tensorflowjs_models\",a=\"info\",n=\"model_topology\",l=\"weight_specs\",h=\"weight_data\",g=\"model_metadata\";function d(){if(!(0,e.env)().getBool(\"IS_BROWSER\")||\"undefined\"==typeof window||void 0===window.localStorage)throw new Error(\"purgeLocalStorageModels() cannot proceed because local storage is unavailable in the current environment.\");const t=window.localStorage,o=[];for(let e=0;e<t.length;++e){const r=t.key(e),a=i+s;if(r.startsWith(a)&&r.length>a.length){t.removeItem(r);const e=S(r);-1===o.indexOf(e)&&o.push(e)}}return o}function c(e){return{info:[i,e,a].join(s),topology:[i,e,n].join(s),weightSpecs:[i,e,l].join(s),weightData:[i,e,h].join(s),modelMetadata:[i,e,g].join(s)}}function S(e){const t=e.split(s);if(t.length<3)throw new Error(`Invalid key format: ${e}`);return t.slice(1,t.length-1).join(s)}function m(e){return e.startsWith(w.URL_SCHEME)?e.slice(w.URL_SCHEME.length):e}class w{constructor(t){if(!(0,e.env)().getBool(\"IS_BROWSER\")||\"undefined\"==typeof window||void 0===window.localStorage)throw new Error(\"The current environment does not support local storage.\");if(this.LS=window.localStorage,null==t||!t)throw new Error(\"For local storage, modelPath must not be null, undefined or empty.\");this.modelPath=t,this.keys=c(this.modelPath)}async save(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error(\"BrowserLocalStorage.save() does not support saving model topology in binary formats yet.\");{const r=JSON.stringify(e.modelTopology),s=JSON.stringify(e.weightSpecs),i=(0,o.getModelArtifactsInfoForJSON)(e);try{return this.LS.setItem(this.keys.info,JSON.stringify(i)),this.LS.setItem(this.keys.topology,r),this.LS.setItem(this.keys.weightSpecs,s),this.LS.setItem(this.keys.weightData,(0,o.arrayBufferToBase64String)(e.weightData)),this.LS.setItem(this.keys.modelMetadata,JSON.stringify({format:e.format,generatedBy:e.generatedBy,convertedBy:e.convertedBy,userDefinedMetadata:e.userDefinedMetadata})),{modelArtifactsInfo:i}}catch(t){throw this.LS.removeItem(this.keys.info),this.LS.removeItem(this.keys.topology),this.LS.removeItem(this.keys.weightSpecs),this.LS.removeItem(this.keys.weightData),this.LS.removeItem(this.keys.modelMetadata),new Error(`Failed to save model '${this.modelPath}' to local storage: `+\"size quota being exceeded is a possible cause of this failure: \"+`modelTopologyBytes=${i.modelTopologyBytes}, `+`weightSpecsBytes=${i.weightSpecsBytes}, `+`weightDataBytes=${i.weightDataBytes}.`)}}}async load(){const e=JSON.parse(this.LS.getItem(this.keys.info));if(null==e)throw new Error(`In local storage, there is no model with name '${this.modelPath}'`);if(\"JSON\"!==e.modelTopologyType)throw new Error(\"BrowserLocalStorage does not support loading non-JSON model topology yet.\");const t={},r=JSON.parse(this.LS.getItem(this.keys.topology));if(null==r)throw new Error(`In local storage, the topology of model '${this.modelPath}' `+\"is missing.\");t.modelTopology=r;const s=JSON.parse(this.LS.getItem(this.keys.weightSpecs));if(null==s)throw new Error(`In local storage, the weight specs of model '${this.modelPath}' `+\"are missing.\");t.weightSpecs=s;const i=this.LS.getItem(this.keys.modelMetadata);if(null!=i){const e=JSON.parse(i);t.format=e.format,t.generatedBy=e.generatedBy,t.convertedBy=e.convertedBy,t.userDefinedMetadata=e.userDefinedMetadata}const a=this.LS.getItem(this.keys.weightData);if(null==a)throw new Error(\"In local storage, the binary weight values of model \"+`'${this.modelPath}' are missing.`);return t.weightData=(0,o.base64StringToArrayBuffer)(a),t}}exports.BrowserLocalStorage=w,w.URL_SCHEME=\"localstorage://\";const y=t=>(0,e.env)().getBool(\"IS_BROWSER\")&&!Array.isArray(t)&&t.startsWith(w.URL_SCHEME)?f(t.slice(w.URL_SCHEME.length)):null;function f(e){return new w(e)}exports.localStorageRouter=y,r.IORouterRegistry.registerSaveRouter(y),r.IORouterRegistry.registerLoadRouter(y);class u{constructor(){(0,t.assert)((0,e.env)().getBool(\"IS_BROWSER\"),()=>\"Current environment is not a web browser\"),(0,t.assert)(\"undefined\"==typeof window||void 0!==window.localStorage,()=>\"Current browser does not appear to support localStorage\"),this.LS=window.localStorage}async listModels(){const e={},t=i+s,o=s+a;for(let r=0;r<this.LS.length;++r){const s=this.LS.key(r);if(s.startsWith(t)&&s.endsWith(o)){e[S(s)]=JSON.parse(this.LS.getItem(s))}}return e}async removeModel(e){const t=c(e=m(e));if(null==this.LS.getItem(t.info))throw new Error(`Cannot find model at path '${e}'`);const o=JSON.parse(this.LS.getItem(t.info));return this.LS.removeItem(t.info),this.LS.removeItem(t.topology),this.LS.removeItem(t.weightSpecs),this.LS.removeItem(t.weightData),o}}exports.BrowserLocalStorageManager=u;"},"sourceMaps":null,"error":null,"hash":"c7f2f595350e0339e84ce37e154b91bb","cacheData":{"env":{}}}